{% load static %}

<!doctype html>
<html lang="en">
  <head>    
    {% block meta %}
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% endblock %}

    {% block extra_meta %}
    {% endblock %}

    {% block corecss %}
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Sofia+Sans+Condensed:wght@500&display=swap" rel="stylesheet">    
       <link rel="stylesheet" href="{% static 'css/base.css' %}">
        {% endblock %}

    {% block extra_css %}
    {% endblock %}

    {% block corejs %}
        <script src="https://kit.fontawesome.com/7aab5ae5f2.js" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <!-- Stripe javascript link. Put in base.html so available on all other pages-enables fraud detection -->
        <script src="https://js.stripe.com/v3/"></script>
    {% endblock %}

    {% block extra_corejs %}
    {% endblock %}

    <title>Fit <i>For</i> Work {% block extra_title %} {% endblock %}</title>
  </head>
  <body>
    <header class="container-fluid fixed-top">
        <div id="topnav" class="row bg-white pt-lg-2 d-none d-lg-flex">
            <div class="col-12 col-lg-4 my-auto py-1 py-lg-0 text-center text-lg-left">
                <a href="{% url 'ffw' %}" class="nav-link main-logo-link">
                    <h2 class="logo-font text-black my-0"><strong>Fit</strong> For <strong>Work</strong></h2>
                </a>
            </div>
            <div class="col-12 col-lg-4 my-auto py-1 py-lg-0">
                <form method="GET" action="{% url 'plans' %}">
                    <div class="input-group w-100">
                        <input class="form-control border border-black rounded-0" type="text" name="q" placeholder="Have a peek">
                        <div class="input-group-append">
                            <button class="form-control btn btn-black border border-black rounded-0" type="submit">
                                <span class="icon">
                                    <i class="fas fa-search"></i>
                                </span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="col-12 col-lg-4 my-auto py-1 py-lg-0">
                <ul class="list-inline list-unstyled text-center text-lg-right my-0">
                    <li class="list-inline-item dropdown">
                        <a class="text-black nav-link" href="{% url 'profile' %}" id="user-options" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <div class="text-center">
                                <div><i class="fas fa-user fa-lg"></i></div> <!--font awesome user icon-->
                                <p class="my-0">My Account</p>
                            </div>
                        </a>
                        <!--anchor element is parent menu. Data toggle links to Bootstrap javascript and opens the dropdown
                        menu when clicked-->
                        <div class="dropdown-menu border-0" aria-labelledby="user-options">
                            {% if request.user.is_authenticated %}
                                {% if request.user.is_superuser %}
                                    <a href="{% url 'add_plan' %}" class="dropdown-item">Plan Management</a>
                                {% endif %}
                                <a href="{% url 'profile' %}" class="dropdown-item">My Plans</a>
                                <a href="{% url 'account_logout' %}" class="dropdown-item">Logout</a>
                            {% else %}
                                <a href="{% url 'account_signup' %}" class="dropdown-item">Register for FFW</a>
                                <a href="{% url 'account_login' %}" class="dropdown-item">Login</a>
                            {% endif %}
                        </div>
                        <!--Dropdown menu uses several Django template tags to determine what to display in the menu
                        account_logout/signup/login coming from allauth urls in urls.py
                        if person authenticated to be superuser, can access plan management system (Adding, updating and 
                        deleting plans)-->
                    <li class="list-inline-item">
                        <a class="{% if grand_total %}text-info font-weight-bold{% else %}text-black{% endif %} nav-link" href="{% url 'view_bag' %}">
                            <div class="text-center">
                                <div><i class="fas fa-shopping-bag fa-lg"></i></div>
                                <!-- context processor creates grand_total variable-->
                                <p class="my-0">
                                    {% if grand_total %}
                                        €{{ grand_total|floatformat:2 }}
                                    {% else %}
                                        €0.00
                                    {% endif %} 
                                </p>
                            </div>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Final anchor link is shopping bag link or for FFW app, buy your plans link...anchor element with a 
            font awesome icon in it with some Django template logic. Checking whether grand_total template variable exists.
            If it does, we want to display total formatted to two decimal places (float). If not, zero is displayed. Same template
            variable used to determine which classes to apply to the element. If there is something in the bag, the font will be bold
            and a different colour.
        -->
        <div class="row bg-white">
            <nav class="navbar navbar-expand-lg navbar-light w-100">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-nav" aria-controls="main-nav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                {% include 'includes/mobile-top-header.html' %}
                {% include 'includes/main-nav.html' %}
            
                <!--using includes template we added. By using includes, it keeps the base.html template clean and
                individual html files isolated in case we want to make changes-->
            </nav>
        </div>
        <div id="delivery-banner" class="row text-center">
            <div class="col bg-black text-blue">
                <h4 class="logo-font my-1">Free PT consultation if you order more than one plan!</h4>                
            </div>            
        </div>
    </header>
    <!--Django messages have levels which are classifiers (debug, info, error etc for different msg types)
    Per Django docs, these levels can be represented as an integer also. We can choose which of our includes
    we want to render, based on the message level. Check level of message with 'with' statement and render the appropriate 
    toast-->
    {% if messages %}
        <div class="message-container">
            {% for message in messages %}
                {% with message.level as level %}
                    {% if level == 40 %}
                        {% include 'includes/toasts/toast_error.html' %}
                    {% elif level == 30 %}
                        {% include 'includes/toasts/toast_warning.html' %}
                    {% elif level == 25 %}
                        {% include 'includes/toasts/toast_success.html' %}
                    {% else %}
                        {% include 'includes/toasts/toast_info.html' %}
                    {% endif %}
                {% endwith %}
            {% endfor %}
        </div>
    {% endif %}


    {% block page-header %}
    {% endblock %}

    {% block content %}
    {% include 'includes/footer.html' %}
    {% endblock %}

    {% block postload_js %}
    <script type="text/javascript">
        $('.toast').toast('show');
    </script>
    {% endblock %}

  </body>
</html>